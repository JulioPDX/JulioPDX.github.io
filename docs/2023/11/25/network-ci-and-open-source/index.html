<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="">
<meta name="description"
    content="Introduction Wow, it&amp;rsquo;s been a long time since my last blog post. I recently attended the first AutoCon event focusing on network automation. Long story short, it was terrific. Check it out and be on the lookout for the next one. Shortly after AutoCon, two community members sprung up with sweet blog posts. My colleague and friend Dan Hertzberg are resurrecting the blog. The first post went over leveraging ygot to create Go structs." />
<meta name="keywords"
    content=", AVD, Containerlab, GitHub, pre-commit, ruff, Ansible, Docker" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://juliopdx.com/2023/11/25/network-ci-and-open-source/" />


<title>
    
    Network CI and Open Source :: Welcome to the World of Tomorrow  — Welcome to my blog!
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.57323f540d7cbe7c215b2d5060bc45c58f58b905f86869d7183bb27c42937f00.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Network CI and Open Source">
<meta itemprop="description" content="Introduction Wow, it&rsquo;s been a long time since my last blog post. I recently attended the first AutoCon event focusing on network automation. Long story short, it was terrific. Check it out and be on the lookout for the next one. Shortly after AutoCon, two community members sprung up with sweet blog posts. My colleague and friend Dan Hertzberg are resurrecting the blog. The first post went over leveraging ygot to create Go structs."><meta itemprop="datePublished" content="2023-11-25T19:33:45-08:00" />
<meta itemprop="dateModified" content="2023-11-25T19:33:45-08:00" />
<meta itemprop="wordCount" content="4112"><meta itemprop="image" content="https://juliopdx.com/blog/images/network-ci/atanas-malamov.jpg">
<meta itemprop="keywords" content="AVD,Containerlab,GitHub,pre-commit,ruff,Ansible,Docker," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://juliopdx.com/blog/images/network-ci/atanas-malamov.jpg"/>

<meta name="twitter:title" content="Network CI and Open Source"/>
<meta name="twitter:description" content="Introduction Wow, it&rsquo;s been a long time since my last blog post. I recently attended the first AutoCon event focusing on network automation. Long story short, it was terrific. Check it out and be on the lookout for the next one. Shortly after AutoCon, two community members sprung up with sweet blog posts. My colleague and friend Dan Hertzberg are resurrecting the blog. The first post went over leveraging ygot to create Go structs."/>



<meta property="og:title" content="Network CI and Open Source" />
<meta property="og:description" content="Introduction Wow, it&rsquo;s been a long time since my last blog post. I recently attended the first AutoCon event focusing on network automation. Long story short, it was terrific. Check it out and be on the lookout for the next one. Shortly after AutoCon, two community members sprung up with sweet blog posts. My colleague and friend Dan Hertzberg are resurrecting the blog. The first post went over leveraging ygot to create Go structs." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://juliopdx.com/2023/11/25/network-ci-and-open-source/" /><meta property="og:image" content="https://juliopdx.com/blog/images/network-ci/atanas-malamov.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-25T19:33:45-08:00" />
<meta property="article:modified_time" content="2023-11-25T19:33:45-08:00" /><meta property="og:site_name" content="Welcome to the World of Tomorrow" />







<meta property="article:published_time" content="2023-11-25 19:33:45 -0800 PST" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#</span>
            <span class="logo__text">JulioPDX</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#41FF00;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        20 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://juliopdx.com/2023/11/25/network-ci-and-open-source/">Network CI and Open Source</a>
      </h1>

      

      
        <hr />
        <aside id="toc">
          <div class="toc-title">Table of Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#the-why">The why</a></li>
    <li><a href="#requirements">Requirements</a>
      <ul>
        <li><a href="#github-self-hosted-runner">GitHub self-hosted runner</a></li>
        <li><a href="#containerlab">Containerlab</a></li>
        <li><a href="#arista-ceos-images">Arista cEOS images</a></li>
      </ul>
    </li>
    <li><a href="#the-basic-workflow">The basic workflow</a></li>
    <li><a href="#but-its-so-much-more">But it&rsquo;s so much more</a>
      <ul>
        <li><a href="#preparing-the-local-environment">Preparing the local environment</a></li>
        <li><a href="#github-actions">GitHub Actions</a></li>
        <li><a href="#jobs-linters-and-pre-commit">Jobs, Linters, and pre-commit</a></li>
        <li><a href="#avd-validate-state--arista-network-test-automation-anta">AVD validate state &amp; Arista Network Test Automation (ANTA)</a></li>
        <li><a href="#cleaning-the-self-hosted-runner">Cleaning the self-hosted runner</a></li>
      </ul>
    </li>
    <li><a href="#run-the-pipeline">Run the Pipeline</a></li>
    <li><a href="#outro-and-links">Outro and links</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <h1 id="introduction">Introduction</h1>
<p>Wow, it&rsquo;s been a long time since my last blog post. I recently attended the first <a href="https://networkautomation.forum/">AutoCon</a> event focusing on network automation. Long story short, it was terrific. Check it out and be on the lookout for the next one. Shortly after AutoCon, two community members sprung up with sweet blog posts. My colleague and friend Dan Hertzberg are resurrecting the blog. The first post went over leveraging <a href="https://danielhertzberg.net/posts/ygotpt1/">ygot</a> to create Go structs. My now in-person friend Danny Wade also made a new post that <a href="https://devnetdan.com/2023/11/21/naf-autocon0-recap/">recapped AutCon</a>. Both are excellent reads and good people; check them out.</p>
<p>Shortly after the event, I wanted to run a simple continuous integration pipeline with Containerlab and some Arista cEOS nodes. Long story short, it worked! However, I had to add a twist to the pipeline by leveraging a GitHub self-hosted runner.</p>
<p>If you&rsquo;ve read my blogs in the past, you may have run into my six-part blog series on <a href="https://juliopdx.com/2021/10/20/building-a-network-ci/cd-pipeline-part-1/">building a CICD pipeline</a>. Think of this post as a modification or add-on to that previous work. I&rsquo;ll review more tools and provide examples of how they can help you on your network automation journey. I hope you enjoy it.</p>
<h2 id="the-why">The why</h2>
<p>If you got this far, then I&rsquo;ve either hooked you with the introduction, or you&rsquo;re just a fan of my work. Either way, thank you. The main reason for this post is to look at different open-source tools and see how they can be used in our workflows to improve or automate some of the tasks.</p>
<p>One important note! I&rsquo;ll mention a lot of different tools in this blog, don&rsquo;t feel like you have to use all of them. Feel free to explore and choose what works for you and your environment.</p>
<h2 id="requirements">Requirements</h2>
<p>If you want to follow along, you should have a local development machine and a Linux VM or laptop to run the self-hosted runner. In my case, I have it running on a small Linux VM on my Intel NUC (not sponsored). It would be helpful if your development machine has <a href="https://docs.docker.com/engine/install/ubuntu/">Docker installed</a>, but the Linux VM will need it.</p>
<h3 id="github-self-hosted-runner">GitHub self-hosted runner</h3>
<p>GitHub has robust CI tooling within its platform. We can leverage the tooling to create workflows to automate project tasks. These tasks could be auto-assigning team members to issues, testing code, building artifacts, or validating changes on the network.</p>
<p>These &ldquo;actions&rdquo; can run within GitHub&rsquo;s infrastructure to spin up ephemeral environments. This is fantastic, but it could be better when we need this environment to access our containerized network images. The only vendor I am aware of that allows public pulling of their container image is Nokia with their SRLinux platform.</p>
<p>For my setup, I will be using Arista&rsquo;s cEOS images. Instead of hosting the image in a public repository (which I don&rsquo;t think is on the up-and-up), I leveraged the self-hosted runner. Since we manage the self-hosted runner, we can have whatever we want, including container images. More on this in a moment.</p>
<p>GitHub has incredible documentation on <a href="https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/adding-self-hosted-runners">installing a self-hosted runner</a>. I won&rsquo;t duplicate that effort, and I&rsquo;ll link you to their excellent docs. One important thing to note is that their documentation walks us through installing the application and running it within the terminal. We need it to run in the background as a service. To do this, make sure you follow <a href="https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/configuring-the-self-hosted-runner-application-as-a-service">GitHub&rsquo;s docs</a> on doing just that. Below is an example output from my VM running the application.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">❯ sudo ./svc.sh status

/etc/systemd/system/actions.runner.JulioPDX-ci-avd-clab.dev.service
● actions.runner.JulioPDX-ci-avd-clab.dev.service - GitHub Actions Runner <span style="color:#f92672">(</span>JulioPDX-ci-avd-clab.dev<span style="color:#f92672">)</span>
     Loaded: loaded <span style="color:#f92672">(</span>/etc/systemd/system/actions.runner.JulioPDX-ci-avd-clab.dev.service; enabled; vendor preset: enabled<span style="color:#f92672">)</span>
     Active: active <span style="color:#f92672">(</span>running<span style="color:#f92672">)</span> since Wed 2023-11-22 12:28:11 PST; <span style="color:#ae81ff">3</span> days ago
   Main PID: <span style="color:#ae81ff">1713</span> <span style="color:#f92672">(</span>runsvc.sh<span style="color:#f92672">)</span>
      Tasks: <span style="color:#ae81ff">23</span> <span style="color:#f92672">(</span>limit: 4915<span style="color:#f92672">)</span>
     Memory: 1.6G
        CPU: 44min 55.008s
     CGroup: /system.slice/actions.runner.JulioPDX-ci-avd-clab.dev.service
             ├─1713 /bin/bash /home/juliopdx/actions-runner/runsvc.sh
             ├─1716 ./externals/node16/bin/node ./bin/RunnerService.js
             └─1724 /home/juliopdx/actions-runner/bin/Runner.Listener run --sta…

Hint: Some lines were ellipsized, use -l to show in full.
</code></pre></div><h3 id="containerlab">Containerlab</h3>
<p><a href="https://containerlab.dev/">Containerlab</a> is my favorite platform for running labs. Whether I&rsquo;m personally learning, testing, or incorporating it into a blog post like this one, the speed and simplicity Containerlab provides are unmatched. If you are following along, install it with this one-liner.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">bash -c <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>curl -sL https://get.containerlab.dev<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><h3 id="arista-ceos-images">Arista cEOS images</h3>
<p>In one of my earlier <a href="https://juliopdx.com/2021/12/10/my-journey-and-experience-with-containerlab/#how-to-add-networking-images-to-containerlab">blog posts</a>, I talked about how to obtain Arista cEOS images. Make a free account on the site, download whatever version you want, and import the image with Docker. Way before I was an Arista employee, I appreciated that the EOS images were free to obtain; more vendors should do this. A new tool is also available called <a href="https://github.com/titom73/eos-downloader">eos-downloader</a>; it is a command line interface to download Arista EOS images. You should check it out.</p>
<p>That is all you need on the Linux VM running the GitHub self-hosted runner application. At the end of this blog, I&rsquo;ll post a few alternate ways to improve this workflow; feel free to use them as self-learning opportunities.</p>
<h2 id="the-basic-workflow">The basic workflow</h2>
<p>In the most high-level view of our build, we have a local development machine where we can make proposed changes to our test network. The changes in &ldquo;code&rdquo; are then pushed up to GitHub, where automated workflows will run to lint our code, build the configurations, and test it against a short-lived network.</p>
<p><img src="/blog/images/network-ci/d2.svg" alt="Workflow"></p>
<h2 id="but-its-so-much-more">But it&rsquo;s so much more</h2>
<p>If only the world was that simple. A decent amount of tools are available to make this all happen. Feel free to fork or clone the <a href="https://github.com/JulioPDX/ci-avd-clab.git">repository</a> and mess with whatever you want. Below is a view of the folder structure of the repository. Stick with me; I&rsquo;ll do my best to break down every piece.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git clone https://github.com/JulioPDX/ci-avd-clab.git
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&gt; tree -I venv
.
├── ansible.cfg
├── anta
│   ├── anta-inv.yml
│   └── anta-test.yml
├── artifacts
│   ├── config_backup
│   ├── documentation
│   ├── intended
│   │   ├── configs
│   │   ├── structured_configs
│   │   └── test_catalogs
│   └── reports
│       └── anta_reports
├── group_vars
│   ├── all.yml
│   ├── ATD_FABRIC.yml
│   ├── ATD_LAB.yml
│   ├── ATD_SERVERS.yml
│   └── ATD_TENANTS_NETWORKS.yml
├── inventory.yml
├── lab.yml
├── LICENSE
├── playbooks
│   ├── build.yml
│   ├── deploy-net.yml
│   ├── validate-net-anta.yml
│   └── validate-net.yml
├── README.md
├── requirements-dev.txt
├── requirements.txt
├── requirements.yml
└── tasks.py
</code></pre></div><h3 id="preparing-the-local-environment">Preparing the local environment</h3>
<p>The repository also includes a <code>.devcontainer</code> file as well. It is handy if you want to develop within a container environment. I&rsquo;ll walk through setting up a local Python development environment. This assumes you have Python installed. To test more in-depth locally, ensure you have Docker, Containerlab, and a cEOS image available.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cd ci-avd-clab
python3 -m venv venv
source venv/bin/activate
pip install -r requirements-dev.txt
ansible-galaxy collection install -r requirements.yml
</code></pre></div><h3 id="github-actions">GitHub Actions</h3>
<p>GitHub Actions is the CI/CD platform within GitHub. We can leverage GitHub Actions to create automated workflows within our repository. These workflows can be as simple as linting our codebase for any errors or deploying changes to a test network and notifying us of a pass or fail. Below is the entire look at the GitHub Actions file for this example. The file is located in the <code>.github/workflows</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
---
<span style="color:#f92672">name</span>: <span style="color:#ae81ff">Network CI</span>

<span style="color:#f92672">on</span>:
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>:
      - <span style="color:#ae81ff">main</span>
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>:
      - <span style="color:#ae81ff">main</span>

<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">run-linters</span>:
    <span style="color:#f92672">timeout-minutes</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">checkout</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">setup python</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-python@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">run pre-commit</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">pre-commit/action@v3.0.0</span>

  <span style="color:#f92672">dev-build-deploy-test</span>:
    <span style="color:#f92672">needs</span>: <span style="color:#ae81ff">run-linters</span>
    <span style="color:#f92672">env</span>:
      <span style="color:#f92672">ANTA_PASSWORD</span>: <span style="color:#ae81ff">${{ secrets.ANTA_PASSWORD }}</span>
      <span style="color:#f92672">SUDO_PASS</span>: <span style="color:#ae81ff">${{ secrets.SUDO_PASS }}</span>
      <span style="color:#f92672">CEOS_VERSION</span>: <span style="color:#ae81ff">4.30</span><span style="color:#ae81ff">.2F</span>

    <span style="color:#f92672">timeout-minutes</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">avd-ci</span>
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">checkout</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">setup Python</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-python@v4</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">python-version</span>: <span style="color:#e6db74">&#34;3.9&#34;</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">install requirements</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">pip install invoke &amp;&amp; invoke setup-base</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">create topology with containerlab</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo $SUDO_PASS | sudo -S containerlab deploy -t lab.yml --reconfigure</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">build with AVD</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/build.yml</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deploy configuration to nodes</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          ansible-playbook playbooks/deploy-net.yml
</span><span style="color:#e6db74">          sleep 10</span>          

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">run ANTA cli tests</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          anta \
</span><span style="color:#e6db74">              --username admin \
</span><span style="color:#e6db74">              --password $ANTA_PASSWORD \
</span><span style="color:#e6db74">              --inventory anta/anta-inv.yml \
</span><span style="color:#e6db74">              --log-file artifacts/anta.log \
</span><span style="color:#e6db74">              nrfu --catalog anta/anta-test.yml text</span>          

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">validate configuration on nodes</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/validate-net.yml</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">validate configuration on nodes w/anta</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/validate-net-anta.yml</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">destroy lab</span>
        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">always()</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo $SUDO_PASS | sudo -S containerlab destroy -t lab.yml -c</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cleanup self hosted runner</span>
        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">always()</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">TooMuch4U/actions-clean@v2.1</span>
</code></pre></div><p>I&rsquo;ll break this down piece by piece and show you most of the tools from my local development machine along the way.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
---
<span style="color:#f92672">name</span>: <span style="color:#ae81ff">Network CI</span>

<span style="color:#f92672">on</span>:
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>:
      - <span style="color:#ae81ff">main</span>
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>:
      - <span style="color:#ae81ff">main</span>
...
</code></pre></div><p>We define a <code>name</code> for the workflow at the root of the GitHub actions file. This doesn&rsquo;t have any impact on the workflow itself, but it&rsquo;s always helpful to pick a name with meaning. The <code>on</code> key is where things start to get interesting. Here, we can specify what events and branches we would like this workflow to run on.</p>
<p>Currently, we have it running on a pull request event or a push event, both heading towards the main branch. This definition is not something to use in a production environment. You would likely have a workflow file for your feature/fix branches and another for the main branch (the production network).</p>
<h3 id="jobs-linters-and-pre-commit">Jobs, Linters, and pre-commit</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
...
<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">run-linters</span>:
    <span style="color:#f92672">timeout-minutes</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">checkout</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">setup python</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-python@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">run pre-commit</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">pre-commit/action@v3.0.0</span>
...
</code></pre></div><p><code>jobs</code> in GitHub actions define the individual steps we would like performed for a particular&hellip; job. In our example, we have one job that handles the linting of the code base and another that deals with building and testing a virtual network. Right below the job key is the unique name of <code>run-linters</code>, which is user-defined, but again, it should make sense. We then have a <code>runs-on</code> key. The <code>runs-on</code> key defines what platform we would like under the hood for this workflow. You could have a macOS, Windows, or Linux environment. This could also be on the GitHub infrastructure or self-hosted.</p>
<p>The <code>run-linters</code> job doesn&rsquo;t need access to our self-hosted runner or the container images. It only needs access to the repository. To save on my personal resources, this job uses the <code>ubuntu-latest</code> variant of a GitHub runner (the node performing the steps), which runs on GitHub&rsquo;s infrastructure. Another thing to note: the <code>timeout-minutes</code> will end the workflow if we exceed that time. This workflow should be far from that, so hitting that limit should signal that we have an issue.</p>
<p>The <code>steps</code> in actions are the units of work we would like performed. We jokingly called them a collection of bash scripts that do a thing. The first two steps are standard in Python projects; we use <code>checkout</code> to make the repository available to the runner and <code>setup-python</code> to ensure Python is in our PATH.</p>
<h4 id="pre-commit">pre-commit</h4>
<p>The last step in this job is to run pre-commit. Pre-commit allows us to automate processes before or during the commit process in our development workflow. For example, we could run linters to check for extra new lines in files, lint YAML, or maybe even Python code.</p>
<p>Pre-commit works by defining a <code>.pre-commit.yaml</code> file at the root of our project. Below is a view of the local one from the repository. Automating these processes enables not only yourself but contributors to your project. There is no question on what rules to follow or how Python code should look, &ldquo;just run pre-commit.&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .pre-commit-config.yaml</span>
---
<span style="color:#f92672">repos</span>:
  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/pre-commit/pre-commit-hooks</span>
    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v4.5.0</span>
    <span style="color:#f92672">hooks</span>:
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">check-yaml</span>
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">end-of-file-fixer</span>
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">trailing-whitespace</span>
  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/ansible/ansible-lint</span>
    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v6.22.0</span>
    <span style="color:#f92672">hooks</span>:
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">ansible-lint</span>
  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/adrienverge/yamllint.git</span>
    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v1.33.0</span>
    <span style="color:#f92672">hooks</span>:
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">yamllint</span>
  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/DavidAnson/markdownlint-cli2</span>
    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v0.11.0</span>
    <span style="color:#f92672">hooks</span>:
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">markdownlint-cli2</span>
  - <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/astral-sh/ruff-pre-commit</span>
    <span style="color:#75715e"># Ruff version.</span>
    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v0.1.6</span>
    <span style="color:#f92672">hooks</span>:
      <span style="color:#75715e"># Run the linter.</span>
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">ruff</span>
      <span style="color:#75715e"># Run the formatter.</span>
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">ruff-format</span>
</code></pre></div><p>The pre-commit configuration for each tool is mostly the same; some have additional available arguments. In the configuration file, we set the <code>repo</code> location, the <code>rev</code> or version we want, and what <code>hook</code> from the repository. Many hooks can exist in a single repository. For more examples, check out the list of <a href="https://pre-commit.com/hooks.html">available pre-commit hooks</a> (not all-encompassing).</p>
<p>There are two options when running pre-commit. You can add it to your git hooks(<code>pre-commit install</code>), and it will run anytime you try and commit, or you can run it manually (<code>pre-commit run -a</code>). Below is a quick example of pre-commit in action.</p>
<p>The following shows some user errors in files and pre-commit attempts to correct them.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&gt; pre-commit run -a
check yaml...............................................................Passed
fix end of files.........................................................Failed
- hook id: end-of-file-fixer
- exit code: <span style="color:#ae81ff">1</span>
- files were modified by this hook

Fixing lab.yml
Fixing group_vars/ATD_TENANTS_NETWORKS.yml

trim trailing whitespace.................................................Passed
Ansible-lint.............................................................Passed
yamllint.................................................................Passed
markdownlint-cli2........................................................Passed
ruff.....................................................................Passed
ruff-format..............................................................Failed
- hook id: ruff-format
- files were modified by this hook

<span style="color:#ae81ff">1</span> file reformatted
</code></pre></div><p>The following is an example of pre-commit passing all checks.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&gt; pre-commit run -a
check yaml...............................................................Passed
fix end of files.........................................................Passed
trim trailing whitespace.................................................Passed
Ansible-lint.............................................................Passed
yamllint.................................................................Passed
markdownlint-cli2........................................................Passed
ruff.....................................................................Passed
ruff-format..............................................................Passed
</code></pre></div><p>Feel free to explore the documentation of the various linters used and see if any others will benefit you in your workflows.</p>
<h4 id="the-second-job">The second job</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
...
  <span style="color:#f92672">dev-build-deploy-test</span>:
    <span style="color:#f92672">needs</span>: <span style="color:#ae81ff">run-linters</span>
    <span style="color:#f92672">env</span>:
      <span style="color:#f92672">ANTA_PASSWORD</span>: <span style="color:#ae81ff">${{ secrets.ANTA_PASSWORD }}</span>
      <span style="color:#f92672">SUDO_PASS</span>: <span style="color:#ae81ff">${{ secrets.SUDO_PASS }}</span>
      <span style="color:#f92672">CEOS_VERSION</span>: <span style="color:#ae81ff">4.30</span><span style="color:#ae81ff">.2F</span>

    <span style="color:#f92672">timeout-minutes</span>: <span style="color:#ae81ff">15</span>
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">avd-ci</span>
...
</code></pre></div><p>Moving down the actions file, we now have our second job. Again, we have a name, but now you can see a new key called <code>needs</code>. This key tells this job to wait for the <code>run-linters</code> job to complete before it runs. We also specify three environment variables we would like available to the runner. The <code>ANTA_PASSWORD</code> reflects the password used to connect to EOS nodes in future steps. <code>SUDO_PASS</code> is used to pass along the credential when running Containerlab. These are within the GitHub actions' secrets; set them under the secrets view.</p>
<p><img src="/blog/images/network-ci/secrets.png" alt="&ldquo;Setting GitHub actions secrets&rdquo;"></p>
<p>The last variable specifies the version of cEOS I&rsquo;m using, which is then referenced in the Containerlab topology file. A preview of that is below. In my case, the image is tagged as <code>ceos:4.30.2F</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...
<span style="color:#f92672">topology</span>:
  <span style="color:#f92672">kinds</span>:
    <span style="color:#f92672">ceos</span>:
      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">ceos:${CEOS_VERSION:=4.30.2F}</span>
...
</code></pre></div><p>The end of the workflow file above mentions a new <code>runs-on</code> value. Installing the self-hosted application instructs us to set a tag or use the default. Below is a view of my runner with the <code>avd-ci</code> tag available. Your installation will be different.</p>
<p><img src="/blog/images/network-ci/runner-done.png" alt="&ldquo;View of runner in GitHub actions&rdquo;"></p>
<h4 id="invoke-and-containerlab">Invoke and Containerlab</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
...
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">checkout</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">setup Python</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-python@v4</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">python-version</span>: <span style="color:#e6db74">&#34;3.9&#34;</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">install requirements</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">pip install invoke &amp;&amp; invoke setup-base</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">create topology with containerlab</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo $SUDO_PASS | sudo -S containerlab deploy -t lab.yml --reconfigure</span>
...
</code></pre></div><p>Top-level portions are similar to our first job; the main difference is that we are specifying a specific Python version that should be in our PATH this time. Similar to my earlier comment that pre-commit hooks have additional arguments, action steps also have them.</p>
<p>The last two steps use the <code>run</code> variant. This simply means &ldquo;run the following commands on the runner.&rdquo; Invoke was new for me on this journey; I like to think of Invoke as a more Pythonic replacement for Makefiles. Invoke allows us to automate tasks as well by defining them in Python. Below is an example of the <code>setup_base</code> function, which leverages two other functions; <code>install_python_reqs</code> and <code>install_ansible_collections</code>. We can use this to ensure our self-hosted runner has all our requirements installed.</p>
<p>The last step listed shows the use of our <code>SUDO_PASS</code> environment variable; we need the variable to run Containerlab as sudo. Please let me know if you know of a better or easier way to make this work. The Containerlab command always runs with the <code>--reconfigure</code> flag. We basically always want the environment to be a fresh deployment. You could also build this to never shut down the test environment; that would remove the build times in the workflow.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># tasks.py</span>
<span style="color:#f92672">...</span>
<span style="color:#a6e22e">@task</span>()
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setup_base</span>(ctx):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Set up the development container environment.
</span><span style="color:#e6db74">    This task runs other tasks to install various requirements.
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>

    <span style="color:#75715e"># Install Python project and development requirements</span>
    install_python_reqs(ctx)

    <span style="color:#75715e"># Install Ansible collection requirements</span>
    install_ansible_collections(ctx)


<span style="color:#a6e22e">@task</span>()
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">install_python_reqs</span>(ctx):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Install project Python requirements.
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    print(<span style="color:#e6db74">&#34;Installing Project Python Requirements&#34;</span>)
    ctx<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#34;pip install --upgrade pip&#34;</span>)
    ctx<span style="color:#f92672">.</span>run(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;pip install -r </span><span style="color:#e6db74">{</span>REQUIREMENTS_FILE_PYTHON_DEV<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)


<span style="color:#a6e22e">@task</span>()
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">install_ansible_collections</span>(ctx):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    Install Ansible collection requirements, including Arista AVD collection.
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    print(<span style="color:#e6db74">&#34;Installing Project Ansible Collection Requirements&#34;</span>)
    ctx<span style="color:#f92672">.</span>run(
        <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ansible-galaxy collection install -r </span><span style="color:#e6db74">{</span>REQUIREMENTS_FILE_ANSIBLE<span style="color:#e6db74">}</span><span style="color:#e6db74"> --force-with-deps&#34;</span>
    )
<span style="color:#f92672">...</span>
</code></pre></div><p>A view of our lab file is below. It&rsquo;s a single spine and two leaf deployment.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># lab.yml</span>
---
<span style="color:#f92672">name</span>: <span style="color:#ae81ff">ci-avd</span>
<span style="color:#f92672">prefix</span>: <span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#f92672">mgmt</span>:
  <span style="color:#f92672">network</span>: <span style="color:#ae81ff">statics</span>
  <span style="color:#f92672">ipv4-subnet</span>: <span style="color:#ae81ff">172.100.100.0</span><span style="color:#ae81ff">/24</span>

<span style="color:#f92672">topology</span>:
  <span style="color:#f92672">kinds</span>:
    <span style="color:#f92672">ceos</span>:
      <span style="color:#f92672">image</span>: <span style="color:#ae81ff">ceos:${CEOS_VERSION:=4.30.2F}</span>
  <span style="color:#f92672">nodes</span>:
    <span style="color:#f92672">spine1</span>:
      <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ceos</span>
      <span style="color:#f92672">mgmt-ipv4</span>: <span style="color:#ae81ff">172.100.100.11</span>
    <span style="color:#f92672">leaf1</span>:
      <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ceos</span>
      <span style="color:#f92672">mgmt-ipv4</span>: <span style="color:#ae81ff">172.100.100.13</span>
    <span style="color:#f92672">leaf2</span>:
      <span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ceos</span>
      <span style="color:#f92672">mgmt-ipv4</span>: <span style="color:#ae81ff">172.100.100.14</span>
  <span style="color:#f92672">links</span>:
    - <span style="color:#f92672">endpoints</span>: [<span style="color:#e6db74">&#34;spine1:eth1&#34;</span>, <span style="color:#e6db74">&#34;leaf1:eth1&#34;</span>]
    - <span style="color:#f92672">endpoints</span>: [<span style="color:#e6db74">&#34;spine1:eth2&#34;</span>, <span style="color:#e6db74">&#34;leaf2:eth1&#34;</span>]

</code></pre></div><p>If you are following along or would like to test locally, feel free to spin up the lab</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">sudo clab deploy -t lab.yml
</code></pre></div><h4 id="arista-validated-designs">Arista Validated Designs</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
...
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">build with AVD</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/build.yml</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">deploy configuration to nodes</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          ansible-playbook playbooks/deploy-net.yml
</span><span style="color:#e6db74">          sleep 10</span>          
...
</code></pre></div><p><a href="https://avd.arista.com/4.4/index.html">AVD</a> is an interesting framework. It allows us to define our network using abstracted data models. For example, if I want to add a new VLAN or VRF, I would define that in a common YAML file related to the nodes in my topology. I may want to define common services like NTP, DNS, etc. I would do that from a common or specific (depending on the use case) YAML file. For example, run the following Ansible playbook to see what AVD accomplishes.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ansible-playbook playbooks/build.yml
</code></pre></div><p>The definitions for this deployment are defined under the <code>group_vars</code> directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># playbooks/build.yml</span>
---
- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Build EOS config</span>
  <span style="color:#f92672">hosts</span>: <span style="color:#ae81ff">ATD_FABRIC</span>
  <span style="color:#f92672">connection</span>: <span style="color:#ae81ff">local</span>
  <span style="color:#f92672">gather_facts</span>: <span style="color:#66d9ef">false</span>

  <span style="color:#f92672">tasks</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Generate intended variables</span>
      <span style="color:#f92672">ansible.builtin.import_role</span>:
        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">arista.avd.eos_designs</span>

    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Generate device intended config and documentation</span>
      <span style="color:#f92672">ansible.builtin.import_role</span>:
        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">arista.avd.eos_cli_config_gen</span>
</code></pre></div><p>Please note every CLI output in this blog is in real-time.</p>
<p><a href="https://asciinema.org/a/624520"><img src="https://asciinema.org/a/624520.svg" alt="asciicast AVD ansible"></a></p>
<p>AVD leverages roles within Ansible to abstract away a lot of the complexity. The neat thing is that we have complete running and structured configurations (in YAML) per device and site documentation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">├── artifacts
│   ├── config_backup
│   ├── documentation
│   │   ├── ATD_FABRIC
│   │   │   ├── ATD_FABRIC-documentation.md
│   │   │   ├── ATD_FABRIC-p2p-links.csv
│   │   │   └── ATD_FABRIC-topology.csv
│   │   └── devices
│   │       ├── leaf1.md
│   │       ├── leaf2.md
│   │       └── spine1.md
│   ├── intended
│   │   ├── configs
│   │   │   ├── leaf1.cfg
│   │   │   ├── leaf2.cfg
│   │   │   └── spine1.cfg
│   │   ├── structured_configs
│   │   │   ├── leaf1.yml
│   │   │   ├── leaf2.yml
│   │   │   └── spine1.yml
</code></pre></div><p>Feel free to review the generated artifacts or modify the <code>ATD_TENANTS_NETOWRKS.yml</code> file with an additional SVI and rerun the build playbook.</p>
<h5 id="the-bonus-example">The bonus example</h5>
<p>When AVD was first created, it was available as an Ansible collection; now we can leverage the Python implementation of  AVD using <code>pyavd</code>. A reasonably rough Python script is in the repository if you want to test it. Please note <code>pyavd</code> is in beta, so your mileage may vary.</p>
<p>You may need to install <code>ansible</code> instead of only installing <code>ansible-core</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">pip install ansible rich pyavd
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># avd-py.py</span>
<span style="color:#f92672">import</span> copy
<span style="color:#f92672">import</span> difflib
<span style="color:#f92672">import</span> io
<span style="color:#f92672">import</span> sys
<span style="color:#f92672">from</span> ansible.inventory.manager <span style="color:#f92672">import</span> InventoryManager
<span style="color:#f92672">from</span> ansible.parsing.dataloader <span style="color:#f92672">import</span> DataLoader
<span style="color:#f92672">from</span> ansible.vars.manager <span style="color:#f92672">import</span> VariableManager
<span style="color:#f92672">from</span> rich.progress <span style="color:#f92672">import</span> Progress
<span style="color:#f92672">from</span> pyavd <span style="color:#f92672">import</span> (
    get_avd_facts,
    get_device_structured_config,
    get_device_config,
    validate_inputs,
)
<span style="color:#f92672">from</span> rich <span style="color:#f92672">import</span> print


<span style="color:#75715e"># Recreating the inventory objects to be like  Ansible</span>
dl <span style="color:#f92672">=</span> DataLoader()
im <span style="color:#f92672">=</span> InventoryManager(loader<span style="color:#f92672">=</span>dl, sources<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;inventory.yml&#34;</span>])
vm <span style="color:#f92672">=</span> VariableManager(loader<span style="color:#f92672">=</span>dl, inventory<span style="color:#f92672">=</span>im)

hosts <span style="color:#f92672">=</span> {}

<span style="color:#75715e"># grab all the hosts and add the hostname with relevant</span>
<span style="color:#75715e"># variables to the hosts dictionary</span>
<span style="color:#75715e"># deep copy required to make sure information is not overwritten</span>
<span style="color:#66d9ef">for</span> host <span style="color:#f92672">in</span> im<span style="color:#f92672">.</span>get_hosts(<span style="color:#e6db74">&#34;all&#34;</span>):
    host_vars <span style="color:#f92672">=</span> vm<span style="color:#f92672">.</span>get_vars(host<span style="color:#f92672">=</span>host)
    hosts[str(host)] <span style="color:#f92672">=</span> copy<span style="color:#f92672">.</span>deepcopy(host_vars)

<span style="color:#66d9ef">with</span> Progress() <span style="color:#66d9ef">as</span> progress:
    <span style="color:#75715e"># progress bars for pretty output</span>
    total <span style="color:#f92672">=</span> len(hosts)
    task1 <span style="color:#f92672">=</span> progress<span style="color:#f92672">.</span>add_task(<span style="color:#e6db74">&#34;[red]facts...&#34;</span>, total<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
    task2 <span style="color:#f92672">=</span> progress<span style="color:#f92672">.</span>add_task(<span style="color:#e6db74">&#34;[blue]validate inputs...&#34;</span>, total<span style="color:#f92672">=</span>total)
    task3 <span style="color:#f92672">=</span> progress<span style="color:#f92672">.</span>add_task(<span style="color:#e6db74">&#34;[yellow]structured config...&#34;</span>, total<span style="color:#f92672">=</span>total)
    task4 <span style="color:#f92672">=</span> progress<span style="color:#f92672">.</span>add_task(<span style="color:#e6db74">&#34;[green]build config...&#34;</span>, total<span style="color:#f92672">=</span>total)

    facts <span style="color:#f92672">=</span> get_avd_facts(hosts)
    progress<span style="color:#f92672">.</span>update(task1, advance<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

    <span style="color:#75715e"># loop to check the state of validate status and print</span>
    <span style="color:#75715e"># any errors</span>
    <span style="color:#66d9ef">for</span> k, v <span style="color:#f92672">in</span> hosts<span style="color:#f92672">.</span>items():
        validate <span style="color:#f92672">=</span> validate_inputs(v)

        <span style="color:#66d9ef">if</span> validate<span style="color:#f92672">.</span>failed:
            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;The following validation errors were seen for </span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
            <span style="color:#66d9ef">for</span> issue <span style="color:#f92672">in</span> validate<span style="color:#f92672">.</span>validation_errors:
                print(issue)
            sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
        progress<span style="color:#f92672">.</span>update(task2, advance<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

        struct_conf <span style="color:#f92672">=</span> get_device_structured_config(k, v, facts)
        progress<span style="color:#f92672">.</span>update(task3, advance<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

        config <span style="color:#f92672">=</span> get_device_config(struct_conf)
        buf <span style="color:#f92672">=</span> io<span style="color:#f92672">.</span>StringIO(config)
        print(k)
        <span style="color:#66d9ef">try</span>:
            <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;artifacts/intended/configs/</span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">.cfg&#34;</span>) <span style="color:#66d9ef">as</span> file:
                old <span style="color:#f92672">=</span> file<span style="color:#f92672">.</span>readlines()

            <span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> difflib<span style="color:#f92672">.</span>unified_diff(old, buf<span style="color:#f92672">.</span>readlines(), lineterm<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>):
                print(line)

            <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;artifacts/intended/configs/</span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">.cfg&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> f:
                f<span style="color:#f92672">.</span>writelines(config)

        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">FileNotFoundError</span>:
            <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;artifacts/intended/configs/</span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">.cfg&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> f:
                f<span style="color:#f92672">.</span>writelines(config)

        progress<span style="color:#f92672">.</span>update(task4, advance<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)

</code></pre></div><p><a href="https://asciinema.org/a/624519"><img src="https://asciinema.org/a/624519.svg" alt="asciicast AVD Python"></a></p>
<p>The last step deals with running a configuration replacement on our nodes from the generated configurations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># playbooks/deploy-net.yml</span>
---
- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Build EOS config</span>
  <span style="color:#f92672">hosts</span>: <span style="color:#ae81ff">ATD_FABRIC</span>
  <span style="color:#f92672">connection</span>: <span style="color:#ae81ff">local</span>
  <span style="color:#f92672">gather_facts</span>: <span style="color:#66d9ef">false</span>

  <span style="color:#f92672">tasks</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Generate intended variables</span>
      <span style="color:#f92672">ansible.builtin.import_role</span>:
        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">arista.avd.eos_config_deploy_eapi</span>

</code></pre></div><p><a href="https://asciinema.org/a/624523"><img src="https://asciinema.org/a/624523.svg" alt="asciicast"></a></p>
<p>I don&rsquo;t have a Python configuration replacement example but feel free to experiment and create one. You could always use something like <a href="https://github.com/napalm-automation/napalm">NAPALM</a>, <a href="https://github.com/ktbyers/netmiko">Netmiko</a>, or <a href="https://github.com/carlmontanari/scrapli">Scrapli</a>.</p>
<h3 id="avd-validate-state--arista-network-test-automation-anta">AVD validate state &amp; Arista Network Test Automation (ANTA)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">...
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">run ANTA cli tests</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          anta \
</span><span style="color:#e6db74">              --username admin \
</span><span style="color:#e6db74">              --password $ANTA_PASSWORD \
</span><span style="color:#e6db74">              --inventory anta/anta-inv.yml \
</span><span style="color:#e6db74">              --log-file artifacts/anta.log \
</span><span style="color:#e6db74">              nrfu --catalog anta/anta-test.yml text</span>          

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">validate configuration on nodes</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/validate-net.yml</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">validate configuration on nodes w/anta</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">ansible-playbook playbooks/validate-net-anta.yml</span>
...
</code></pre></div><p>AVD has a role to validate the state of our deployed network. Below is an example of the playbook and the output. The validate state role will also produce reports on passing or failing tests.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ansible-playbook playbooks/validate-net.yml
</code></pre></div><p><a href="https://asciinema.org/a/624526"><img src="https://asciinema.org/a/624526.svg" alt="asciicast"></a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">artifacts/reports
├── anta_reports
├── ATD_FABRIC-state.csv
└── ATD_FABRIC-state.md
</code></pre></div><p><a href="https://www.anta.ninja/stable/">ANTA</a> is the new kid on the block for network testing. There are a few ways to implement ANTA. We can use it directly in Python, leverage the CLI tool, or in a preview release within AVD Ansible. The ANTA AVD variant makes things fairly automated as far as test definitions. We basically set the <code>use_anta</code> variable to <code>true</code>. Below is the view of the playbook and the output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">---
- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Validate deployed config</span>
  <span style="color:#f92672">hosts</span>: <span style="color:#ae81ff">ATD_FABRIC</span>
  <span style="color:#f92672">connection</span>: <span style="color:#ae81ff">httpapi</span>
  <span style="color:#f92672">gather_facts</span>: <span style="color:#66d9ef">false</span>

  <span style="color:#f92672">vars</span>:
    <span style="color:#f92672">use_anta</span>: <span style="color:#66d9ef">true</span>

  <span style="color:#f92672">tasks</span>:
    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Validate EOS state with ANTA</span>
      <span style="color:#f92672">ansible.builtin.import_role</span>:
        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">arista.avd.eos_validate_state</span>

</code></pre></div><p>Below is the output from the ANTA validate playbook.</p>
<p><a href="https://asciinema.org/a/624528"><img src="https://asciinema.org/a/624528.svg" alt="asciicast"></a></p>
<p>Below is a quick example of one of the generated artifacts.</p>
<p><a href="https://asciinema.org/a/624530"><img src="https://asciinema.org/a/624530.svg" alt="asciicast"></a></p>
<p>ANTA also has a CLI, which requires two main parts: an inventory definition and a test catalog.</p>
<p>Here&rsquo;s a view of our inventory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># anta/anta-inv.yml</span>
---
<span style="color:#f92672">anta_inventory</span>:
  <span style="color:#f92672">hosts</span>:
    - <span style="color:#f92672">host</span>: <span style="color:#ae81ff">172.100.100.11</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">spine1</span>
      <span style="color:#f92672">tags</span>: [<span style="color:#e6db74">&#34;fabric&#34;</span>, <span style="color:#e6db74">&#34;spine&#34;</span>]
    - <span style="color:#f92672">host</span>: <span style="color:#ae81ff">172.100.100.13</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">leaf1</span>
      <span style="color:#f92672">tags</span>: [<span style="color:#e6db74">&#34;fabric&#34;</span>, <span style="color:#e6db74">&#34;leaf&#34;</span>, <span style="color:#e6db74">&#34;pod1&#34;</span>]
    - <span style="color:#f92672">host</span>: <span style="color:#ae81ff">172.100.100.14</span>
      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">leaf2</span>
      <span style="color:#f92672">tags</span>: [<span style="color:#e6db74">&#34;fabric&#34;</span>, <span style="color:#e6db74">&#34;leaf&#34;</span>, <span style="color:#e6db74">&#34;pod2&#34;</span>]

</code></pre></div><p>Here&rsquo;s a look at the test catalog. These are YAML representations of the Python classes in the code. Head to the <a href="https://www.anta.ninja/stable/api/tests/">documentation</a> to see what&rsquo;s available. I&rsquo;ll show an example of a pass and a fail.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">---
<span style="color:#f92672">anta.tests.software</span>:
  <span style="color:#75715e"># Verifies the device is running one of the allowed EOS version.</span>
  - <span style="color:#f92672">VerifyEOSVersion</span>:
      <span style="color:#75715e"># List of allowed EOS versions.</span>
      <span style="color:#f92672">versions</span>:
        - <span style="color:#ae81ff">4.30</span><span style="color:#ae81ff">.2F-33092737.4302F (engineering build)</span>

<span style="color:#f92672">anta.tests.routing.generic</span>:
  - <span style="color:#f92672">VerifyRoutingProtocolModel</span>:
      <span style="color:#f92672">model</span>: <span style="color:#e6db74">&#34;multi-agent&#34;</span>

<span style="color:#f92672">anta.tests.routing.bgp</span>:
  - <span style="color:#f92672">VerifyBGPPeersHealth</span>:
      <span style="color:#f92672">address_families</span>:
        - <span style="color:#f92672">afi</span>: <span style="color:#ae81ff">ipv4</span>
          <span style="color:#f92672">safi</span>: <span style="color:#ae81ff">unicast</span>

<span style="color:#f92672">anta.tests.vxlan</span>:
  - <span style="color:#f92672">VerifyVxlan1Interface</span>:
  - <span style="color:#f92672">VerifyVxlanConfigSanity</span>:

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">export ANTA_PASSWORD<span style="color:#f92672">=</span>somesecretpassword
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">anta <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--username admin <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--password $ANTA_PASSWORD <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--inventory anta/anta-inv.yml <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--log-file artifacts/anta.log <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>nrfu --catalog anta/anta-test.yml table
</code></pre></div><p><a href="https://asciinema.org/a/624535"><img src="https://asciinema.org/a/624535.svg" alt="asciicast"></a></p>
<p>I&rsquo;ll slightly edit by modifying the Routing Protocol Model.</p>
<p><a href="https://asciinema.org/a/624536"><img src="https://asciinema.org/a/624536.svg" alt="asciicast"></a></p>
<h3 id="cleaning-the-self-hosted-runner">Cleaning the self-hosted runner</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># .github/workflows/dev.yml</span>
...
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">destroy lab</span>
        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">always()</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo $SUDO_PASS | sudo -S containerlab destroy -t lab.yml -c</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">cleanup self hosted runner</span>
        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">always()</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">TooMuch4U/actions-clean@v2.1</span>
</code></pre></div><p>The GitHub runners are usually ephemeral; we don&rsquo;t have to worry about cleanup. The self-hosted runner is different since the environment can last indefinitely. We use these last steps to clean up files we don&rsquo;t need and destroy our topology. Please note the new key of <code>if</code>; we want these steps to run no matter what happens in the pipeline run.</p>
<h2 id="run-the-pipeline">Run the Pipeline</h2>
<p>Wow, that was a lot of information. Please let me know if you have any questions or feel something needs clarification. I&rsquo;ll add a new service to the network by editing the <code>group_vars/ATD_TENANTS_NETWORKS.yml</code> file and then pushing it up to the repository, which should kick off a pipeline run.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># ATD_TENANTS_NETWORKS.yml</span>
---
<span style="color:#f92672">tenants</span>:
  <span style="color:#75715e"># Tenant A Specific Information - VRFs / VLANs</span>
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Tenant_A</span>
    <span style="color:#f92672">mac_vrf_vni_base</span>: <span style="color:#ae81ff">10000</span>
    <span style="color:#f92672">vrfs</span>:
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Tenant_A_OP_Zone</span>
        <span style="color:#f92672">vrf_vni</span>: <span style="color:#ae81ff">10</span>
        <span style="color:#f92672">vtep_diagnostic</span>:
          <span style="color:#f92672">loopback</span>: <span style="color:#ae81ff">100</span>
          <span style="color:#f92672">loopback_ip_range</span>: <span style="color:#ae81ff">10.255.1.0</span><span style="color:#ae81ff">/24</span>
        <span style="color:#f92672">svis</span>:
          - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">110</span>
            <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Tenant_A_OP_Zone_1</span>
            <span style="color:#f92672">tags</span>: [<span style="color:#ae81ff">opzone]</span>
            <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">true</span>
            <span style="color:#f92672">ip_address_virtual</span>: <span style="color:#ae81ff">10.1.10.1</span><span style="color:#ae81ff">/24</span>
          - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">111</span>
            <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Tenant_A_OP_Zone_2</span>
            <span style="color:#f92672">tags</span>: [<span style="color:#ae81ff">opzone]</span>
            <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">true</span>
            <span style="color:#f92672">ip_address_virtual</span>: <span style="color:#ae81ff">10.1.11.1</span><span style="color:#ae81ff">/24</span>
    <span style="color:#f92672">l2vlans</span>:
      - <span style="color:#f92672">id</span>: <span style="color:#ae81ff">160</span>
        <span style="color:#f92672">vni_override</span>: <span style="color:#ae81ff">55160</span>
        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Tenant_A_VMOTION</span>
        <span style="color:#f92672">tags</span>: [<span style="color:#ae81ff">vmotion]</span>

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git add .
git commit -m <span style="color:#e6db74">&#34;something&#34;</span>
git push
</code></pre></div><p><img src="/blog/images/network-ci/linters-complete.png" alt="&ldquo;View of linters running&rdquo;"></p>
<p><img src="/blog/images/network-ci/deploy-lab-runner.png" alt="&ldquo;View of runner in GitHub actions&rdquo;"></p>
<p><img src="/blog/images/network-ci/building.png" alt="&ldquo;View of runner in GitHub actions&rdquo;"></p>
<p><img src="/blog/images/network-ci/anta-cli.png" alt="&ldquo;View of runner in GitHub actions&rdquo;"></p>
<p><img src="/blog/images/network-ci/complete.png" alt="&ldquo;View of runner in GitHub actions&rdquo;"></p>
<h2 id="outro-and-links">Outro and links</h2>
<p>Thank you all so much for reading this far. I hope something in here is helpful in your automation journey. Please explore and plug tools into different areas to see if you can make it work. Massive shout-out to Ryan Merolle; he deserves much credit for the work on this repository. Thank you so much for contributing.</p>
<ul>
<li><a href="https://unsplash.com/photos/lake-surrounded-by-pine-trees-near-snow-covered-mountain-tpmAv6c33dE">Featured Image Atanas Malamov</a></li>
<li><a href="https://twitter.com/ryanmerolle">Ryan on Twitter/X</a>, give him a follow</li>
<li><a href="https://github.com/JulioPDX/ci-avd-clab">GitHub repository</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://juliopdx.com/tags/avd/">AVD</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/containerlab/">Containerlab</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/github/">GitHub</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/pre-commit/">pre-commit</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/ruff/">ruff</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/ansible/">Ansible</a></span>
        <span class="tag"><a href="https://juliopdx.com/tags/docker/">Docker</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        4112 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2023-11-25 19:33
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>
        

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="https://juliopdx.com/2023/04/29/building-my-first-mechanical-keyboard/">
                    <span class="button__text">Building my first mechanical keyboard</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://juliopdx.com/"></a></span>
            
            <span><a href="https://juliopdx.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
    
    <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="juliopdx" data-description="Support me on Buy me a coffee!" data-message="Thank you for all the support. Caffeine helps keep the blogs coming!" data-color="#40DCA5" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.45347cbb0cde6339c7e2884209e89aa98d055beefeef8208af7478ccbc2924f3f7db788a9419f3598da668e58e658febcd7d84f60c6108ccad165d369af8a363.js" integrity="sha512-RTR8uwzeYznH4ohCCeiaqY0FW&#43;7&#43;74IIr3R4zLwpJPP323iKlBnzWY2maOWOZY/rzX2E9gxhCMytFl02mvijYw=="></script>



    </body>
</html>
